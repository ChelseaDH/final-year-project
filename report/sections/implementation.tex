%! TEX root = ../report.tex

% A detailed account of the implementation and testing of your software
% Explain the conceptual structure of the algorithms.
% Also explain what data structures you used
    % how the algorithms were implemented
% What implementation decisions did you take, and why?
    % There is no need to list every little function and procedure and explain its working in elaborate detail; use your judgement on what is appropriate to include

\chapter{Implementation}
\todo{Describe the basic packet-flow operation}

    \section{Standalone Library}

        % netstack_init()
        % netstack_cleanup()
        %

    \section{Header Manipulation}

    \section{Interfaces}\label{sec:intf}

    \section{Internet Protocol}

        \subsection{Routing}

    \section{\mbox{Address Resolution Protocol}}

    \section{Sockets}

    \section{TCP}

        \subsection{Segment Arrives}






        \subsection{Concurrency}

    \section{Socket API}
        \subsection{Netstack API}
        % TCP user functions join together the internal tcp calls and perform error checking.
        % Perform sufficient locking to prevent concurrent modification of the state whilst it's being read

            \subsubsection{Send}
            % Calls tcp_send_data
            % Waits for space in send window

            \subsubsection{Recieve}
            % Copies the largest contiguous available byte range
            % Waits for incoming segments


        \subsection{BSD Socket API}
            % socket, bind, listen, connect, send, recv, shutdown all work
            % getsockopt, setsockopt, fcntl implemented but do nothing
            % O_NONBLOCK isn't working

    \section{Memory Management}

        % refcounting
        \subsection{Reference Counting}

    % logging with macros for verbose logs
    \section{Logging}

    \section{Issues}
        \subsection{Standards}
        % RFC 793 is incomplete and very vague

        \subsection{Threading \& Locking}
        % refcount
        % pthread_cond
        % arp request waiting on recv thread

        % BSD socket API design
        % non-blocking I/O (poll/select) :(

